# 机房预约系统



## 项目需求



* 首先进入登录界面，可选登录身份有：
  * 学生代表
  * 老师
  * 管理员
  * 退出
* 每个身份都需要进行验证后，进入子菜单
  * 学生需要输入 ：学号、姓名、登录密码
  * 老师需要输入：职工号、姓名、登录密码
  * 管理员需要输入：管理员姓名、登录密码
* 学生具体功能
  * 申请预约    ---   预约机房
  * 查看自身的预约    ---  查看自己的预约状态
  * 查看所有预约   ---   查看全部预约信息以及预约状态
  * 取消预约    ---   取消自身的预约，预约成功或审核中的预约均可取消
  * 注销登录    ---   退出登录
* 教师具体功能
  * 查看所有预约   ---   查看全部预约信息以及预约状态
  * 审核预约    ---   对学生的预约进行审核
  * 注销登录    ---   退出登录
* 管理员具体功能
  * 添加账号    ---   添加学生或教师的账号，需要检测学生编号或教师职工号是否重复
  * 查看账号    ---   可以选择查看学生或教师的全部信息
  * 查看机房    ---   查看所有机房的信息
  * 清空预约    ---   清空所有预约记录
  * 注销登录    ---   退出登录



## 项目流程



### 创建、菜单、退出、身份类

1. 创建机房预约系统源文件，提供主函数接口
2. 循环调用菜单界面，开关语句接收用户输入
3. 退出分支提示后阻塞，return 0结束程序
4. 创建身份的抽象基类：两个属性—用户名、密码，一个纯虚子菜单接口
5. 学生类继承身份类，包含特性属性学号与以下接口：
6. 默认构造，有参构造，菜单界面，申请预约，查看我的预约，查看所有预约，取消预约。全部空实现
7. 教师类继承身份类，包含特性属性职工号与以下接口：
8. 默认构造，有参构造，菜单界面，查看所有预约，审核预约。全部空实现
9. 管理员类继承身份类，包含以下接口：
10. 默认构造，有参构造，菜单界面，添加账号，查看账号，查看机房信息，清空预约记录。全部空实现

### 登陆

1. 添加globalFile头文件，添加总共五份宏常量记录用到的全局文件，并在当前目录下创建这些文件
2. 主函数文件扩展登陆全局函数(文件名,身份类型)。菜单调用
3. 准备一个身份类空指针后，进行读文件检定
4. 准备三个变量，输入用户名、密码，依身份判断是否要输入学号或职工号
5. 依身份进行登录验证。空实现
6. 验证登录失败后提示
7. 主菜单调用不同的登陆接口
8. 下面实现学生登陆验证：
9. 在当前目录下学生文件里添加几条信息，字段间空格分割，记录间换行
10. 准备三个变量存储文件读入的字段
11. 循环读入三个字段后判断是否对应相等
12. 验证成功后身份指针指向学生：堆区开辟，有参构造
13. 教师登陆验证同上
14. 管理员登录验证同上

### 管理员

**登陆注销：**

1. 管理员有参构造实现
2. 主函数文件扩展管理员菜单全局函数(Identity *manager)
3. 实现管理员的开场菜单
4. 管理员菜单里循环调用开场展示菜单
5. 形参强转成子类指针后依用户输入调用不同功能接口
6. 注销登录可实现，delete后return掉
7. 登录验证里接口对接，调用管理员菜单

**添加账号：**

1. 提示添加账号的类型，学生或老师
2. 准备两个字符串，文件名和提示语
3. 准备一个输出流对象，一个整型接收用户输入
4. 依输入不同给文件名和提示语赋值
5. 以输出和追加方式打开文件
6. 准备一个整型，两个字符串
7. 分别提示并接收用户输入
8. 输出到文件，三个字段以空格分割，换行
9. 提示添加成功
10. 进行去重操作，管理员类添加两个v容器，一个初始化容器的接口
11. 接口内先清空两个容器
12. 读文件检定后，循环读入学生对象后插入容器中，关闭
13. 重复以上操作读入老师信息
14. 管理员有参构造调用此接口
15. 管理员扩展验重接口 bool f(id,type)
16. 依类型遍历容器重复返回真，最后返回假
17. 添加账号里准备一个错误提示字符串
18. 依输入不同给错误提示赋值
19. 输入id时，循环验重并输出错误提示
20. 每次添加成功后重新调用初始化接口

**显示账号：**

1. 提示查看内容，学生或老师
2. 依选择遍历对应容器拿到所有信息

**查看机房：**

1. 机房文件里手动写数据，字段间空格分割
2. 创建机房类，两个属性，id号、最大容量
3. 管理类里添加一个机房容器
4. 有参构造读入机房信息到容器里
5. 查看机房里遍历机房容器输出信息

**清空预约：**

1. trunc方式打开文件
2. 关掉，提示清空成功

### 学生

**登陆注销：**

1. 学生类有参构造实现
2. 主函数文件扩展学生菜单全局函数(Identity*student)
3. 实现学生的开场菜单
4. 学生菜单里循环调用开场展示菜单
5. 形参强转成子类指针后依用户输入调用不同功能接口
6. 注销登录可实现，delete后return掉
7. 登录验证里接口对接，调用学生菜单

**申请预约：**

1. 学生类添加一个机房容器
2. 有参构造里循环读入机房信息到容器中
3. 申请预约里提示机房开放时间
4. 准备三个整型，日期、时间段、机房号
5. 提示申请预约的时间，接收用户输入
6. 提示申请预约的时间段，接收用户输入
7. 提示机房与容量大小，接收用户输入
8. 声明预约成功，审核中
9. 以追加方式输出到订单文件中，格式如下
10. date: interval: stuId: stuName: room: status: 字段间空格分割，结尾换行

**显示预约：**

1. 创建订单文件类
2. 包含两个属性：预约记录条数，map<int,map<string,string>>维护所有订单记录的容器
3. 两个接口：默认构造，更新预约记录
4. 构造里记录条数初始化，准备6个字符串
5. 循环接收从订单文件读到的每个字段
6. 准备一个map<string,string>容器
7. 扩展取键值对的函数(field,&map<string>)
8. 多次调用此函数，将<条数,容器>全部插入维护的订单容器，条数自增
9. 循环结束
10. 更新预约记录：以out|trunc方式打开订单文件，将维护的订单记录全部写入文件
11. 显示自身预约：判断是否有记录
12. 有则开始遍历记录，查找维护的容器中键为stuId的值是否匹配自身学号
13. 注意：这里需要先用c_str转成const char*，再用atoi转成整型
14. 找到后输出记录信息，学号姓名pass
15. 时段用三目输出上下午
16. 准备一个状态字符串，依status
17. 拼接四种状态：取消，审核，通过，失败
18. 输出状态信息
19. 显示所有预约：同显示自身预约，但无需查key，额外输出学号与姓名字段

**取消预约：**

1. 判断是否有记录
2. 有则提示哪种状态的记录可以取消
3. 准备一个v容器，存放下标映射
4. 准备一个整型，存放视图中的记录索引
5. 遍历容器并检索属于自己的记录
6. 再次检索状态后，下标插入v中
7. 输出带索引的所有信息，姓名学号pass
8. 提示输入取消的记录，提供一个放弃接口
9. 接收用户输入，是一个视图的记录索引
10. 合法则找到v中的映射
11. 据此映射找到数据中真正的记录更改状态
12. 更新到文件，提示取消成功

### 教师

**登陆注销：**

1. 教师类有参构造实现
2. 主函数文件扩展教师菜单全局函数(Identity*teacher)
3. 实现教师的开场菜单
4. 教师菜单里循环调用开场展示菜单
5. 形参强转成子类指针后依用户输入调用不同功能接口
6. 注销登录可实现，delete后return掉
7. 登录验证里接口对接，调用教师菜单

**查看所有预约：**

1. 判断是否有记录
2. 有则开始遍历记录，输出所有记录信息
3. 准备status字符串拼接四种状态后输出

**审核预约：**

1. 判断是否有记录
2. 有则提示待审核的预约记录
3. 准备一个v容器，存放下标映射
4. 准备一个整型，存放视图中的记录索引
5. 遍历容器并检索属于待审核的记录
6. 下标插入v中，输出带索引的信息，学生信息pass
7. 提示输入审核的记录，提供一个放弃接口
8. 准备两个整型，存两次选择
9. 接收视图索引输入，接收审核结果输入
10. 通过地址变换定位记录，更改状态
11. 更新到文件，提示审核完毕